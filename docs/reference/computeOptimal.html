<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="ChIPanalyser contains a set of functions some of which require two
parameters known as lambdaPWM and as
boundMolecules. These two paramters are not always known.
computeOptimal will compute these values by maximising the
correlation and minimising the Mean Squared Error between a predicted
ChIP-seq-like profile and a real ChIP-seq profile for a given loci."><title>compute Optimal Parameters — computeOptimal • ChIPanalyser</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="compute Optimal Parameters — computeOptimal"><meta property="og:description" content="ChIPanalyser contains a set of functions some of which require two
parameters known as lambdaPWM and as
boundMolecules. These two paramters are not always known.
computeOptimal will compute these values by maximising the
correlation and minimising the Mean Squared Error between a predicted
ChIP-seq-like profile and a real ChIP-seq profile for a given loci."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ChIPanalyser</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/ChIPanalyser.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GA_ChIPanalyser.html">The ChIPanalyser User's Guide</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>compute Optimal Parameters</h1>
      
      <div class="d-none name"><code>computeOptimal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ChIPanalyser</code> contains a set of functions some of which require two
parameters known as <code><a href="lambdaPWM.html">lambdaPWM</a></code> and as
<code><a href="boundMolecules.html">boundMolecules</a></code>. These two paramters are not always known.
<code>computeOptimal</code> will compute these values by maximising the
correlation and minimising the Mean Squared Error between a predicted
ChIP-seq-like profile and a real ChIP-seq profile for a given loci.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">computeOptimal</span><span class="op">(</span><span class="va">genomicProfiles</span>,<span class="va">DNASequenceSet</span>, <span class="va">ChIPScore</span>,chromatinState <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parameterOptions <span class="op">=</span> <span class="cn">NULL</span>, optimalMethod <span class="op">=</span> <span class="st">"all"</span>,rank<span class="op">=</span><span class="cn">FALSE</span>,returnAll<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    peakMethod<span class="op">=</span><span class="st">"moving_kernel"</span>,cores<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>genomicProfiles</dt>
<dd><p><code>genomicProfiles</code> is a <code><a href="genomicProfiles.html">genomicProfiles</a></code>
     object containing at least a Postion Frequency Matrix or a
     Position Weight Matrix. It is strongly advised to customize this object to
     increase goodness of fit of the model when compared to real ChIP-seq data.</p></dd>

    <dt>DNASequenceSet</dt>
<dd><p><code>DNASequenceSet</code> is a <code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">DNAStringSet</a></code> or
    a <code>BSgenome</code> of the full sequence of the organism of interest.</p></dd>


    <dt>ChIPScore</dt>
<dd><p><code>ChIPScore</code> is a named list containing ChIP-seq enrichements for
    each Loci of interest. This Profile should be normalised to a base
    pair level. In other words, there should be an enrichement score for
    each base pair of a given Locus.</p></dd>



    <dt>chromatinState</dt>
<dd><p><code>chromatinState</code> is a <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code> object
    containing either accesible sites or DNA affinity scores.</p></dd>


    <dt>parameterOptions</dt>
<dd><p><code><a href="parameterOptions.html">parameterOptions</a></code> is a
    <code><a href="parameterOptions.html">parameterOptions</a></code> object.
    If this object is not provided (parameterOptions = NULL),
    a new object will be created internally.
    However, it is strongly advised to tailor this object to maximise the
    goodness of fit of the model when compared to ChIP-seq data.</p></dd>

    <dt>optimalMethod</dt>
<dd><p><code>optimalMethod</code> is a character string which determines which
    method for optimal parameter selection should be selected. optimalMethod
    can be one of the following:
    pearson, spearman, kendall, ks, fscore, geometric,MSE, or all. Default is set
    to all.</p></dd>

    <dt>rank</dt>
<dd><p><code>rank</code> is a logical value indicating if optimal parameters should be
    based on rank (parameter combination occuring the most over all regions) or
    avaerage score (best perfomring combination of paramters on average over all
    regions selected). DEFAULT = FALSE</p></dd>

    <dt>returnAll</dt>
<dd><p><code>returnAll</code> is a logical value indicating if all internal objects
    should be returned. DEFAULT = TRUE. Internal objects are the following:
    Occupancy Scores, ChIP like profiles, goodness of fit metrics and optimal
    paramters. If set to FALSE, <code>computeOptimal</code> will only return the optimal
    parameters.</p></dd>

    <dt>peakMethod</dt>
<dd><p><code>peakMethod</code> is a character string  of one of the following:
    c("moving_kernel","truncated_kernel","exact"). If set to moving_kernel,
    the peaks will be approximated using Rcpp (Default).
    If set to truncated_kernel, the peaks will be approximated
    however this method does not require Rcpp. If set to exact, the peaks will
    not be approximated.</p>
<p></p></dd>

    <dt>cores</dt>
<dd><p><code>cores</code> is the number cores that will be used to compute optimal
    set of parameters.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In order to backward infer the values of <code><a href="lambdaPWM.html">lambdaPWM</a></code>
and <code><a href="boundMolecules.html">boundMolecules</a></code>, it is possible to use the
<code>computeOptimal</code> to find these parameters.
It should be noted that this functions requires a ChIP-seq data input.
<code>ChIPScore</code> (ChIP-seq data). This should be the output of the <code><a href="processingChIP.html">processingChIP</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>computeOptimal</code> returns a list respectivly described as the optimal
set of Parameters (lambda - <code><a href="lambdaPWM.html">lambdaPWM</a></code> and
<code><a href="boundMolecules.html">boundMolecules</a></code>), the optimal matrix (a matrix containing
accuracy estimates dependant on the parameter chosen), and finally the
chosen parameter. If the parameter that was chosen was "all",
then each element of this list will contain the optimal set of
parameters, optimal matricies for all of the aforementioned paramters (see <code>optimalMethod</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Zabet NR, Adryan B (2015) Estimating binding properties of transcription
factors from genome-wide binding profiles. Nucleic Acids Res., 43, 84–94.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Patrick C. N. Martin &lt;pm16057@essex.ac.uk&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Data extraction</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ChIPanalyserData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># path to Position Frequency Matrix</span></span></span>
<span class="r-in"><span><span class="va">PFM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package<span class="op">=</span><span class="st">"ChIPanalyser"</span><span class="op">)</span>,<span class="st">"BEAF-32.pfm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#As an example of genome, this example will run on the Drosophila genome</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"BSgenome.Dmelanogaster.UCSC.dm6"</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"BSgenome.Dmelanogaster.UCSC.dm6"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BSgenome.Dmelanogaster.UCSC.dm6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DNASequenceSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/getSeq.html" class="external-link">getSeq</a></span><span class="op">(</span><span class="va">BSgenome.Dmelanogaster.UCSC.dm6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chip</span><span class="op">&lt;-</span><span class="fu"><a href="processingChIP.html">processingChIP</a></span><span class="op">(</span><span class="va">chip</span>,<span class="va">top</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Building data objects</span></span></span>
<span class="r-in"><span><span class="va">GPP</span> <span class="op">&lt;-</span> <span class="fu"><a href="genomicProfiles.html">genomicProfiles</a></span><span class="op">(</span>PFM<span class="op">=</span><span class="va">PFM</span>,PFMFormat<span class="op">=</span><span class="st">"JASPAR"</span>,BPFrequency<span class="op">=</span><span class="va">DNASequenceSet</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">OPP</span> <span class="op">&lt;-</span> <span class="fu"><a href="parameterOptions.html">parameterOptions</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Computing Optimal set of Parameters</span></span></span>
<span class="r-in"><span><span class="va">optimalParam</span> <span class="op">&lt;-</span> <span class="fu">computeOptimal</span><span class="op">(</span>genomicProfiles <span class="op">=</span> <span class="va">GPP</span>,</span></span>
<span class="r-in"><span>    DNASequenceSet <span class="op">=</span> <span class="va">DNASequenceSet</span>,</span></span>
<span class="r-in"><span>    ChIPScore <span class="op">=</span> <span class="va">chip</span>,</span></span>
<span class="r-in"><span>    chromatinState <span class="op">=</span> <span class="va">Access</span>,</span></span>
<span class="r-in"><span>    parameterOptions <span class="op">=</span> <span class="va">OPP</span>,</span></span>
<span class="r-in"><span>    parameter <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>    peakMethod<span class="op">=</span><span class="st">"moving_kernel"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in computeOptimal(genomicProfiles = GPP, DNASequenceSet = DNASequenceSet,     ChIPScore = chip, chromatinState = Access, parameterOptions = OPP,     parameter = "all", peakMethod = "moving_kernel"):</span> unused argument (parameter = "all")</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Patrick CN Martin, Nicolea Radu Zabet.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

